<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.campus.management.controller.AdminController"
            prefWidth="900"
            prefHeight="600"
            style="-fx-background-color: linear-gradient(to bottom, #f8fafc, #e2e8f0);"
            stylesheets="@theme.css">

    <!-- Sidebar -->
    <left>
        <VBox spacing="20" alignment="TOP_CENTER"
              style="-fx-background-color: #4f46e5;"
              prefWidth="220">
            <padding>
                <Insets top="30" right="15" bottom="30" left="15"/>
            </padding>

            <!-- Profile / Brand -->
            <VBox alignment="CENTER" spacing="10">
                <ImageView fitWidth="80" fitHeight="80" preserveRatio="true">
                    <image>
                        <Image url="@../images/person.png"/>
                    </image>
                </ImageView>
                <Label text="Admin Panel" style="-fx-font-size: 18px; -fx-font-weight: bold;-fx-text-fill: white;"/>
                <Label text="System Administrator" style="-fx-font-size: 12px; -fx-text-fill: #94a3b8;"/>
            </VBox>

            <Separator style="-fx-opacity: 0.1; -fx-background-color: white;"/>

            <!-- Navigation -->
            <VBox spacing="10" VBox.vgrow="ALWAYS">
                <Button fx:id="dashboardBtn" text="Dashboard" maxWidth="Infinity" styleClass="icon-button" style="-fx-text-fill: white; -fx-alignment: CENTER_LEFT; -fx-background-color: transparent;" onAction="#showDashboard"/>
                <Button fx:id="eventsBtn" text="Events" maxWidth="Infinity" styleClass="icon-button" style="-fx-text-fill: white; -fx-alignment: CENTER_LEFT; -fx-background-color: transparent;" onAction="#showEventsView"/>
                <Button fx:id="usersBtn" text="Users" maxWidth="Infinity" styleClass="icon-button" style="-fx-text-fill: white; -fx-alignment: CENTER_LEFT; -fx-background-color: transparent;" onAction="#showUsersView"/>
            </VBox>

            <Button text="Logout" maxWidth="Infinity" styleClass="secondary-button" style="-fx-background-color: #ef4444; -fx-text-fill: white; -fx-border-color: transparent;" onAction="#onLogout"/>
        </VBox>
    </left>

    <!-- Main Content -->
    <center>
        <VBox spacing="20">
            <padding>
                <Insets top="30" right="30" bottom="30" left="30"/>
            </padding>

            <!-- Main Content Stack -->
            <StackPane VBox.vgrow="ALWAYS">

                <!-- Dashboard View -->
                <VBox fx:id="dashboardView" spacing="25">
                     <VBox>
                        <Label text="Dashboard" styleClass="title"/>
                        <Label text="Overview of system statistics." styleClass="subtitle"/>
                     </VBox>

                     <HBox spacing="20">
                         <VBox styleClass="stat-card-blue">
                             <Label text="ðŸ“… Total Events" styleClass="stat-label"/>
                             <Label fx:id="totalEventsLabel" text="0" styleClass="stat-value"/>
                         </VBox>

                         <VBox styleClass="stat-card-green">
                             <Label text="ðŸ‘¥ Total Users" styleClass="stat-label"/>
                             <Label fx:id="totalUsersLabel" text="0" styleClass="stat-value"/>
                         </VBox>

                         <VBox styleClass="stat-card-orange">
                             <Label text="â³ Pending Approvals" styleClass="stat-label"/>
                             <Label fx:id="pendingEventsLabel" text="0" styleClass="stat-value"/>
                         </VBox>
                     </HBox>

                     <!-- Statistics Charts -->
                     <HBox spacing="20" VBox.vgrow="ALWAYS" alignment="CENTER_LEFT">
                         <VBox spacing="10" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 1); -fx-padding: 15;">
                             <Label text="Events by Category" styleClass="subtitle" style="-fx-font-size: 14px;"/>
                             <BarChart fx:id="eventCategoryChart" animated="false" legendVisible="false" VBox.vgrow="ALWAYS">
                                <xAxis>
                                  <CategoryAxis fx:id="xAxis" label="Category"/>
                                </xAxis>
                                <yAxis>
                                  <NumberAxis fx:id="yAxis" label="Count"/>
                                </yAxis>
                             </BarChart>
                         </VBox>

                         <VBox spacing="10" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 1); -fx-padding: 15;">
                             <Label text="Users by Role" styleClass="subtitle" style="-fx-font-size: 14px;"/>
                             <PieChart fx:id="userRoleChart" animated="false" VBox.vgrow="ALWAYS" labelsVisible="true"/>
                         </VBox>
                     </HBox>
                </VBox>
                
                <!-- Event Management View -->
                <VBox fx:id="eventsView" spacing="20" visible="false">
                    <!-- Event Header -->
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <VBox>
                            <Label text="Event Management" styleClass="title"/>
                            <Label text="Approve, reject, or delete events." styleClass="subtitle"/>
                        </VBox>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="statusLabel" style="-fx-text-fill: #64748b;"/>
                    </HBox>

                    <!-- Event Action Toolbar -->
                    <HBox spacing="10" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 1);">
                        <Button text="All Events" onAction="#loadAllEvents" styleClass="secondary-button"/>
                        <Button text="Pending" onAction="#loadPendingEvents" styleClass="primary-button" style="-fx-background-color: #0ea5e9;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                    </HBox>

                    <!-- Event List -->
                    <VBox VBox.vgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 1); -fx-padding: 0;">
                        <ListView fx:id="eventsListView" VBox.vgrow="ALWAYS" style="-fx-background-insets: 0; -fx-padding: 10; -fx-background-color: transparent;"/>
                    </VBox>
                </VBox>

                <!-- User Management View -->
                <VBox fx:id="usersView" spacing="20" visible="false">
                    <!-- User Header -->
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <VBox>
                            <Label text="User Management" styleClass="title"/>
                            <Label text="Manage registered users." styleClass="subtitle"/>
                        </VBox>
                        <Region HBox.hgrow="ALWAYS"/>
                    </HBox>

                    <!-- User Action Toolbar -->
                    <HBox spacing="10" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 1);">
                        <Button text="Load All Users" onAction="#loadAllUsers" styleClass="secondary-button"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="Add Admin" onAction="#addNewAdmin" styleClass="primary-button" style="-fx-background-color: #4f46e5;"/>
                    </HBox>

                    <VBox VBox.vgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 1); -fx-padding: 0;">
                        <ListView fx:id="usersListView" VBox.vgrow="ALWAYS" style="-fx-background-insets: 0; -fx-padding: 10; -fx-background-color: transparent;"/>
                    </VBox>
                </VBox>

            </StackPane>
        </VBox>
    </center>

</BorderPane>
